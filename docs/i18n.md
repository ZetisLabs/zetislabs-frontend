# Internationalization (i18n) Guide

This guide explains how the internationalization system works and how to add or modify translations.

## Overview

The project supports multiple languages using Next.js App Router with locale-based URL routing. Currently supported languages:
- **English (en)** - Default locale
- **French (fr)**

## How It Works

### URL-Based Routing

All routes include the locale prefix:
- `/en` → English homepage
- `/fr` → French homepage
- `/en/blog` → English blog (future)
- `/fr/blog` → French blog (future)

### Language Detection

The middleware (`middleware.ts`) automatically:
1. Detects browser language preference from `Accept-Language` header
2. Redirects root `/` to `/en` or `/fr` based on browser language
3. Validates locale in URL and falls back to default (`en`) if invalid

### Translation System

Translations are stored in JSON files:
- `i18n/translations/en.json` - English translations
- `i18n/translations/fr.json` - French translations

Translation keys use dot notation for nested access:
```typescript
"home.hero.title" → { home: { hero: { title: "..." } } }
```

## Adding New Translations

### Step 1: Add Translation Keys

Edit the translation JSON files (`i18n/translations/en.json` and `i18n/translations/fr.json`):

```json
{
  "home": {
    "newSection": {
      "title": "New Section Title",
      "description": "New section description"
    }
  }
}
```

### Step 2: Use in Components

In your component, import the translation utility and use it:

```typescript
import { getTranslation } from "@/lib/i18n";
import { type Locale } from "@/i18n/config";

type Props = {
  params: Promise<{ locale: Locale }>;
};

export default async function MyComponent({ params }: Props) {
  const { locale } = await params;
  const t = (key: string) => getTranslation(locale, key);

  return (
    <div>
      <h1>{t("home.newSection.title")}</h1>
      <p>{t("home.newSection.description")}</p>
    </div>
  );
}
```

### Step 3: Add French Translation

Add the French equivalent in `i18n/translations/fr.json`:

```json
{
  "home": {
    "newSection": {
      "title": "Titre de la nouvelle section",
      "description": "Description de la nouvelle section"
    }
  }
}
```

## Adding a New Language

### Step 1: Update Configuration

Add the new locale to `i18n/config.ts`:

```typescript
export const locales = ["en", "fr", "es"] as const; // Add "es" for Spanish
export type Locale = (typeof locales)[number];

export const localeNames: Record<Locale, string> = {
  en: "English",
  fr: "Français",
  es: "Español", // Add Spanish name
};
```

### Step 2: Create Translation File

Create `i18n/translations/es.json` with all translation keys:

```json
{
  "metadata": {
    "title": "...",
    "description": "..."
  },
  "header": { ... },
  "footer": { ... },
  "home": { ... }
}
```

### Step 3: Update Translation Utility

The `lib/i18n.ts` file automatically imports all translation files. Make sure to import the new one:

```typescript
import esTranslations from "@/i18n/translations/es.json";

const translations = {
  en: enTranslations,
  fr: frTranslations,
  es: esTranslations, // Add Spanish translations
} as const;
```

### Step 4: Test

Visit `/es` to see the new language in action. The middleware will automatically handle routing.

## Translation File Structure

Translations are organized hierarchically by page/component:

```json
{
  "metadata": {
    "title": "...",
    "description": "..."
  },
  "header": {
    "home": "Home",
    "blog": "Blog"
  },
  "footer": {
    "copyright": "© {year} ZetisLabs. All rights reserved.",
    "privacy": "Privacy"
  },
  "home": {
    "hero": {
      "title": "...",
      "subtitle": "..."
    },
    "whatWeMake": {
      "title": "...",
      "features": {
        "aiAgents": {
          "title": "...",
          "description": "..."
        }
      }
    }
  }
}
```

### Key Organization Principles

1. **Group by page/component** - `home.*`, `header.*`, `footer.*`
2. **Nest related content** - `home.hero.title`, `home.hero.subtitle`
3. **Use descriptive keys** - `whatWeMake.features.aiAgents.title`
4. **Keep consistent structure** - Same keys across all language files

## Using Translations in Components

### Server Components

Server components receive `params` with locale:

```typescript
type Props = {
  params: Promise<{ locale: Locale }>;
};

export default async function ServerComponent({ params }: Props) {
  const { locale } = await params;
  const t = (key: string) => getTranslation(locale, key);
  
  return <h1>{t("home.hero.title")}</h1>;
}
```

### Client Components

Client components receive locale as a prop:

```typescript
type Props = {
  locale: Locale;
};

export default function ClientComponent({ locale }: Props) {
  const t = (key: string) => getTranslation(locale, key);
  
  return <button>{t("home.cta.primary")}</button>;
}
```

### Layout Components

Layout components receive locale from params:

```typescript
export default async function LocaleLayout({ 
  children, 
  params 
}: {
  children: React.ReactNode;
  params: Promise<{ locale: Locale }>;
}) {
  const { locale } = await params;
  // Use locale for metadata, etc.
}
```

## Language Switcher

The `LanguageSwitcher` component (`components/ui/LanguageSwitcher.tsx`) allows users to manually switch languages:

```typescript
<LanguageSwitcher currentLocale={locale} />
```

It automatically:
- Updates the URL to the new locale
- Preserves the current route path
- Updates all translations on the page

## Dynamic Content

For dynamic content like dates or numbers, use string replacement:

```json
{
  "footer": {
    "copyright": "© {year} ZetisLabs. All rights reserved."
  }
}
```

```typescript
const copyright = t("footer.copyright").replace("{year}", currentYear.toString());
```

## Best Practices

1. **Always add translations for all languages** - Don't leave keys missing
2. **Use descriptive key names** - `home.hero.title` not `h1` or `title1`
3. **Keep structure consistent** - Same keys in all language files
4. **Group related translations** - Keep related content together
5. **Test all languages** - Verify translations appear correctly
6. **Use fallback** - Missing translations fall back to default locale (English)

## Troubleshooting

### Translation Not Appearing

1. Check the key exists in the translation file
2. Verify the key path is correct (case-sensitive)
3. Ensure the locale is valid (`en` or `fr`)
4. Check browser console for errors

### Wrong Language Showing

1. Verify middleware is working (check network tab)
2. Check URL has correct locale prefix
3. Clear browser cache and cookies
4. Verify translation file has correct locale code

### Missing Translation Key

If a key is missing, the system falls back to:
1. Default locale (English) translation
2. The key itself if no translation found

Always add missing translations to prevent fallback behavior.

